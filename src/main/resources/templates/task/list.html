<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<head>
    <meta charset="ISO-8859-1">
    <title>home</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css"
          rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU"
          crossorigin="anonymous">

<!--     JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
            crossorigin="anonymous"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

</head>

<body>
<nav class="navbar navbar-light" style="background-color: lightgrey">
<ul class="nav nav-pills">

    <li class="nav-item">
        <a class="nav-link active" aria-current="page">TASK LIST</a>
    </li>

    <li class="nav-item">
        <a class="nav-link" th:href="@{/task/create}">New Task</a>
    </li>

    <li class="nav-item dropdown" style="position: fixed; right:2%; ">
        <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false">Settings</a>
        <ul class="dropdown-menu">
            <li><a class="dropdown-item" th:href="@{/user/profile}">Profle</a></li>
            <li><a class="dropdown-item" th:href="@{/logout}">Logout</a></li>
        </ul>
    </li>

</ul>
</nav>
<div class="container">

<table id="myTable" class="table table-striped table-hover" style="margin-top: 2%">
    <thead>
    <tr>
<!--            <th>Time</th>-->
            <th>TITLE</th>
            <th>DESCRIPTION</th>
            <th>ACTION</th>
    </tr>
    </thead>
</table>
    <p id="hello"></p>
</div>
</body>

<script type = "text/javascript" language = "javascript">
    $(document).ready(function (){
         $.get("/task/listJson",function (data, success){
            //  $.each( data, function() {
               // document.getElementById("hello").innerHTML = JSON.stringify(data);
                 let s_no = 0;
                 let table = document.getElementById("myTable");
                 for (let key in data) {
                     if (data.hasOwnProperty(key)) {
                         let res = {};
                         res = data[key];

                         s_no = s_no + 1;
                         let row = table.insertRow(s_no);

                         row.insertCell(0).innerHTML = res.title;
                         row.insertCell(1).innerHTML = res.desc;

                         let ch1 = "<button onclick='removeTask(this.id)'>Delete</button> ";
                         let ch2 = "<button onclick='updateTask(this.id)'>Update</button> ";
                         row.insertCell(2).innerHTML = ch1.concat(ch2);
                     }
                 }
         });
    })

    // function removeTask(id)
    // {
    //     $.post("/task/update",id);
    // }
    // function updateTask(id)
    // {
    //     $.post("/task/delete",id);
    // }
</script>

</html>